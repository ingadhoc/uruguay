<?xml version='1.0' encoding='utf-8'?>
<odoo>

    <record id="view_move_form_inherit_l10n_uy_edi" model="ir.ui.view">
        <field name="name">account.move.form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="l10n_uy_edi.view_move_form_inherit_l10n_uy_edi"/>
        <field name="arch" type="xml">

            <field name="l10n_uy_edi_addenda_ids" position="attributes">
                <attribute name="context">{'default_type': 'item', 'default_apply_on': 'account.move', 'form_view_ref': 'l10n_uy_edi.l10n_uy_edi_addenda_view_form_only_item'}</attribute>
            </field>

            <sheet position="before">
                <field name="l10n_uy_edi_journal_type" invisible="1"/>
                <div class="alert alert-danger" role="alert" style="margin-bottom:0px;"
                    invisible="l10n_uy_edi_journal_type != 'electronic' or state != 'posted' or invoice_pdf_report_id">
                        <bold>Esta factura esta validada pero le falta el PDF legal asociado, por favor intente re generarlo</bold>
                    <button name="action_l10n_uy_get_pdf" type="object" string="(UY) Reprint Legal PDF"
                        class="oe_inline oe_link" icon="fa-print"
                        invisible="l10n_uy_edi_cfe_state != 'received' or invoice_filter_type_domain == 'purchase'"
                    />
                </div>
                <div class="alert alert-warning" role="alert" style="margin-bottom:0px;"
                    invisible="l10n_uy_edi_journal_type != 'electronic' or state != 'draft' or invoice_pdf_report_id">รง
                        <bold>Esta factura aun no esta validada, asi que si intenta imprimir tendra un PDF no Legal</bold></div>
            </sheet>

            <!-- TODO need to find a way to hide computed_currency_rate field, this one is added in l10n_ar_ux, so.. maybe we should add it in another base
            ux module. to be re used. Meanwhile we do not show l10n_uy_currency_rate -->
            <!--  <div name="currency" position="inside">
                <field name="l10n_uy_currency_rate" attrs="{'invisible': ['|', '|', ('l10n_uy_currency_rate', '=', False), ('l10n_uy_currency_rate', '=', 0.0), ('l10n_uy_currency_rate', '=', 1.0)]}"/>
            </div> -->

            <field name="l10n_uy_edi_cfe_uuid" position="after">

                <button name="uy_ux_action_get_uruware_cfe" type="object" string="Get Uruware Invoice" class="oe_link" colspan="2" invisible="state != 'draft' l10n_uy_edi_journal_type != 'manual'"/>

                <div name="uy_buttons" colspan="2" groups="base.group_no_one" invisible="l10n_uy_edi_journal_type != 'electronic'">
                    <!-- TODO KZ This one should be removed after we fix the problem with the print from menu -->
                    <button name="uy_ux_action_uy_get_pdf" type="object" string="(UY) Print Legal PDF" class="oe_inline oe_link" invisible="l10n_uy_edi_cfe_state not in ['received']" icon="fa-print" groups="base.group_no_one"/>

                </div>
                <field name="l10n_uy_idreq" invisible="invoice_filter_type_domain != 'purchase'"/>
            </field>

            <notebook position="inside">
                <page name="uy_dgi" string="DGI" invisible="l10n_uy_edi_journal_type != 'electronic'">
                    <group string="Adendas and Leyendas">
                        <button name="action_l10n_uy_remkark_default" type="object" string="Get Defaults"/>
                        <field name="l10n_uy_edi_addenda_ids">
                            <tree string="Addendas">
                                <field name="type"/>
                                <field name="name"/>
                                <field name="content"/>
                            </tree>
                        </field>
                        <span>Preview: </span>
                        <button name="action_l10n_uy_addenda_preview" type="object" string="Addendas"/>
                        <button name="action_l10n_uy_mandatory_legend" type="object" string="Info/Leyendas"/>
                    </group>
                    <group string="CFE">
                        <button name="l10n_uy_edi_action_download_preview_xml" type="object" string="Preview" class="oe_inline oe_link" invisible="state != 'draft'"/>
                        <button name="uy_ux_action_validate_cfe" type="object" string="Validate" class="oe_inline oe_link" invisible="state != 'draft'"/>
                        <button name="action_l10n_uy_update_fields" type="object" string="Update Fields"
                            class="oe_inline oe_link" invisible="state != 'draft'"
                            help="Read the XML and fill the fields of the invoice/bill with the xml values"
                            confirm="Are you sure? this action will update the invoice information."/>

                        <field name="l10n_uy_cfe_xml" nolabel="1" widget="ace"/>

                    </group>

                </page>
            </notebook>

        </field>
    </record>

</odoo>
